<% if(LH.isAllow('products', 'PUT::{product}')) { %>
<div class="page__controls">
    <a class="user__editLink"
       href="/products/<%- productModel.id %>/edit">
        Редактировать
    </a>
</div>
<% } %>

<h1 name="name" class="product__name"><%- productModel.name %></h1>

<div class="product__sku" name="sku">
    <%- productModel.sku %>
</div>

<table class="table" style="width: 50%">
    <tr>
        <th>Группа</th>
        <td>
            <a href="/catalog/<%- productModel.subCategory.category.group.id %>" name="group">
                <%- productModel.subCategory.category.group.name %>
            </a>
        </td>
    </tr>
    <tr>
        <th>Категория</th>
        <td>
            <a href="/catalog/<%- productModel.subCategory.category.group.id %>/<%= productModel.subCategory.category.id %>"
               name="category">
                <%- productModel.subCategory.category.name %>
            </a>
        </td>
    </tr>
    <tr>
        <th>Подкатегория</th>
        <td>
            <a href="/catalog/<%- productModel.subCategory.category.group.id %>/<%= productModel.subCategory.category.id %>/<%= productModel.subCategory.id %>"
               name="subCategory">
                <%- productModel.subCategory.name %>
            </a>
        </td>
    </tr>

    <tr>
        <th>Тип товара</th>
        <td name="type">
            <%- LH.productTypes(productModel.type, 'nameCapitalFull') %>
        </td>
    </tr>
    <tr>
        <th>Единица измерения</th>
        <td name="units">
            <%- LH.units(productModel.units, 'capitalFull') %>
        </td>
    </tr>
    <tr>
        <th>НДС</th>
        <td>
            <span name="vat"><%- productModel.vat %></span>
            %
        </td>
    </tr>
    <tr>
        <th>Штрих-код</th>
        <td>
            <span name="barcode"><%- productModel.barcode %></span>
        </td>
    </tr>
    <tr>
        <th>Страна</th>
        <td name="vendorCountry">
            <%- productModel.vendorCountry %>
        </td>
    </tr>
    <tr>
        <th>Производитель</th>
        <td name="vendor">
            <%- productModel.vendor %>
        </td>
    </tr>

    <% if (productModel.type == 'weight') { %>
        <tr>
            <th>Наименование на весах</th>
            <td name="typeProperties.nameOnScales">
                <%- productModel.typeProperties.nameOnScales %>
            </td>
        </tr>
        <tr>
            <th>Описание товара на весах</th>
            <td name="typeProperties.descriptionOnScales">
                <%- productModel.typeProperties.descriptionOnScales %>
            </td>
        </tr>
        <tr>
            <th>Состав</th>
            <td name="typeProperties.ingredients">
                <%- productModel.typeProperties.ingredients %>
            </td>
        </tr>
        <tr>
            <th>Пищевая ценность</th>
            <td name="typeProperties.nutritionFacts">
                <%- productModel.typeProperties.nutritionFacts %>
            </td>
        </tr>
        <tr>
            <th>Срок годности</th>
            <td>
                <span name="typeProperties.shelfLife"><%- productModel.typeProperties.shelfLife %></span>
                <%- productModel.typeProperties.shelfLife? 'ч.' : '' %>
            </td>
        </tr>
    <% } %>

    <% if (productModel.type == 'alcohol') { %>
    <tr>
        <th>Крепость</th>
        <td name="typeProperties.alcoholByVolume">
            <%- productModel.typeProperties.alcoholByVolume !== undefined ? LH.formatAmount(productModel.typeProperties.alcoholByVolume) + '%' : '' %>
        </td>
    </tr>
    <tr>
        <th>Объем тары</th>
        <td name="typeProperties.volume">
            <%- productModel.typeProperties.volume ? LH.formatAmount(productModel.typeProperties.volume) + 'л.' : '' %>
        </td>
    </tr>
    <% } %>

    <tr>
        <th>Закупочная цена</th>
        <td>
            <% if(productModel.purchasePrice){ %>
                <span name="purchasePrice">
                <%- LH.formatMoney(productModel.purchasePrice) %>
                </span>
            руб.
            <% } else { %>
            <i name="purchasePrice">
                отсутствует
            </i>
            <% } %>
        </td>
    </tr>
    <tr>
        <th>Диапазон наценки</th>
        <td>
            <% if(_.isNumber(productModel.retailMarkupMin) && _.isNumber(productModel.retailMarkupMax)) {
            %>
                <span name="retailMarkupRange">
                    <%- LH.formatMoney(productModel.retailMarkupMin) %>
                    -
                    <%- LH.formatMoney(productModel.retailMarkupMax) %>
                </span>
            %
            <% } else { %>
            <i name="retailMarkupRange">
                отсутствует
            </i>
            <% } %>
        </td>
    </tr>
    <tr>
        <th>Диапазон цены продажи</th>
        <td>
            <% if(productModel.retailPriceMin && productModel.retailPriceMax){ %>
                <span name="retailPriceRange">
                    <%- LH.formatMoney(productModel.retailPriceMin) %>
                    -
                    <%- LH.formatMoney(productModel.retailPriceMax) %>
                </span>
            руб.
            <% } else { %>
            <i name="retailPriceRange">
                отсутствует
            </i>
            <% } %>
        </td>
    </tr>
    <tr>
        <th>Округление</th>
        <td>
            <span name="rounding.name">
                <%- LH.getText(productModel.rounding.name) %>
            </span>
        </td>
    </tr>
    <% if(storeProductModel) { %>
    <tr>
        <th>Наценка</th>
        <td>
            <% if(storeProductModel.retailMarkup) { %>
                    <span name="retailMarkup">
                        <%- LH.formatMoney(storeProductModel.retailMarkup) %>
                    </span>
            %
            <% } else { %>
            <i name="retailMarkup">
                отсутствует
            </i>
            <% } %>
        </td>
    </tr>
    <tr>
        <th>Цена продажи</th>
        <td>
            <% if(storeProductModel.roundedRetailPrice) { %>
                    <span name="retailPrice">
                        <%- LH.formatMoney(storeProductModel.roundedRetailPrice) %>
                    </span>
            руб.
            <% } else { %>
            <i name="retailPrice">
                отсутствует
            </i>
            <% } %>
        </td>
    </tr>
    <tr>
        <th>Остаток</th>
        <td>
            <div model="storeProduct" model-attribute="inventoryElement">
                <%= storeProductModel.inventoryElement() %>
                <span model="product" model-attribute="units">
                    <%- LH.units(productModel.units, 'smallShort') %>
                </span>
            </div>
        </td>
    </tr>
    <tr>
        <th>ССО</th>
        <td>
            <div model="storeProduct" model-attribute="averageDailySalesElement">
                <%= storeProductModel.averageDailySalesElement() %>
                <span model="product" model-attribute="units">
                    <%- LH.units(productModel.units, 'smallShort') %>
                </span>
            </div>
        </td>
    </tr>
    <tr>
        <th>УТЗ</th>
        <td>
            <div model="storeProduct" model-attribute="inventoryDaysElement">
                <%= storeProductModel.inventoryDaysElement() %> дн.
            </div>
        </td>
    </tr>
    <% if(LH.isAllow('stores/{store}/products/{product}', 'PUT')) { %>
    <tr>
        <td></td>
        <td>
            <% if(productModel.retailPriceMin && productModel.retailPriceMax){ %>
            <a href="/stores/<%= storeProductModel.store.id %>/products/edit/<%= productModel.id %>">
                Изменить наценку/цену
            </a>
            <% } else { %>
            <span><%- 'Изменить наценку/цену нельзя. Нет диапазона наценки' %></span>
            <% } %>

        </td>
    </tr>
    <% } %>
    <% } %>
</table>
