<% var accounting = require('libs/accounting') %>
<% var getText = require('kit/utils/getText') %>

<% var dayStringDictionary = {
    string: function(day){
        switch (day){
            case 1:
                return 'прошлый понедельник';
                break;
            case 2:
                return 'прошлый вторник';
                break;
            case 3:
                return 'прошлую среду';
                break;
            case 4:
                return 'прошлый четверг';
                break;
            case 5:
                return 'прошлую пятницу';
                break;
            case 6:
                return 'прошлую субботу';
                break;
            case 7:
                return 'прошлое воскресение';
                break;
        }
    }
} %>

<% if (_.any(models)) { %>
<h1>Обзор</h1>
<% } %>
<% if (models.storeGrossSales){ %>
<div class="grossSale grossSale_store">
    <div class="grossSale__subTitle">
        Объём продаж на <%- moment(models.storeGrossSales.get('today.now.date')).startOf('hour').format('HH.mm') %>
    </div>
    <div class="grossSale__todayValue">
        <%- accounting.formatNumber(models.storeGrossSales.get('today.now.value'), 2, ' ', ',') %>
    </div>
    <div class="grossSale__yesterdayDiff">
        На
        <span class="grossSale__diffText <%- models.storeGrossSales.get('yesterday.now.diff') >= 0 ? 'grossSale__diffText_plus' : 'grossSale__diffText_minus'%>">
            <%- Math.abs(models.storeGrossSales.get('yesterday.now.diff'))%> %
            <%= models.storeGrossSales.get('yesterday.now.diff') >= 0 ? 'больше' : 'меньше'%>, чем вчера (<%- accounting.formatNumber(models.storeGrossSales.get('yesterday.now.value'), 2, ' ', ',') %>)
        </span>
    </div>
    <div class="grossSale__weekDiff">
        На
        <span class="grossSale__diffText <%- models.storeGrossSales.get('weekAgo.now.diff') >= 0 ? 'grossSale__diffText_plus' : 'grossSale__diffText_minus'%>">
            <%- Math.abs(models.storeGrossSales.get('weekAgo.now.diff'))%> %
            <%= models.storeGrossSales.get('weekAgo.now.diff') >= 0 ? 'больше' : 'меньше'%>, чем в
            <%- getText(dayStringDictionary, 'string', moment(models.storeGrossSales.get('today.now.date')).day()) %>

            (<%- accounting.formatNumber(models.storeGrossSales.get('weekAgo.now.value'), 2, ' ', ',') %>)
        </span>
    </div>
    <div class="grossSale__subTitle">
        Объём продаж на конец дня
    </div>
    <table class="grossSale__table">
        <tr>
            <td>Вчера</td>
            <td><%- accounting.formatNumber(models.storeGrossSales.get('yesterday.dayEnd.value'), 2, ' ', ',') %></td>
        </tr>
        <tr>
            <td>В <%- getText(dayStringDictionary, 'string', moment(models.storeGrossSales.get('today.now.date')).day()) %></td>
            <td><%- accounting.formatNumber(models.storeGrossSales.get('weekAgo.dayEnd.value'), 2, ' ', ',') %></td>
        </tr>
    </table>
</div>
<% } %>
<% if (!_.any(models)) { %>
<div class="page__logo"></div>
<% } %>
