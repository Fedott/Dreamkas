<?xml-stylesheet href="../-mix/doc.stage=dev.xsl" type="text/xsl"?>
<doc_root
    doc_title="$lh_product_editor"
    >
    
    <div id="lh_product_creator_test">
        <product
            lh_product_creator="true"
        />
    </div>
    
    <div id="lh_product_editor_test">
        <product lh_product_editor="true">
            <id>1</id>
            <sku>GVOZDI007</sku>
            <name>Гвозди 47 колибра</name>
            <vendor>Рога и копыта</vendor>
            <vendorCountry>Россия</vendorCountry>
            <purchasePrice>100500</purchasePrice>
            <barcode>0123456789</barcode>
            <units>unit</units>
            <val>10</val>
            <info>У нас их дофига!</info>
        </product>
    </div>
    
    <p>Все ли поля присутствуют и подхватывают ли они текущие значения</p>
    <p>
        <script type="wc_test">
            var editor= $jq( '#lh_product_creator_test' )
            
            test.ok( editor.find( 'input[name="name"]' ).length, 1 )
            test.ok( editor.find( 'input[name="vendor"]' ).length, 1 )
            test.ok( editor.find( 'input[name="vendorCountry"]' ).length, 1 )
            test.ok( editor.find( 'input[name="purchasePrice"]' ).length, 1 )
            test.ok( editor.find( 'input[name="barcode"]' ).length, 1 )
            
            test.ok( editor.find( 'select[name="units"]' ).length, 1 )
            test.ok( editor.find( 'select[name="units"] > option' ).length > 1 )
            test.ok( editor.find( 'select[name="units"] > option[selected]' ).val(), 'unit' )
            
            test.ok( editor.find( 'select[name="vat"]' ).length, 1 )
            test.ok( editor.find( 'select[name="vat"] > option' ).length > 1 )
            test.ok( editor.find( 'select[name="vat"] > option[selected]' ).val(), '10' )
            
            test.ok( editor.find( 'input[name="sku"]' ).length, 1 )
            test.ok( editor.find( 'input[name="info"]' ).length, 1 )
        </script>
        <script type="wc_test">
            var editor= $jq( '#lh_product_editor_test' )
            
            test.ok( editor.find( 'input[name="name"]' ).val(), 'Гвозди 47 колибра' )
            test.ok( editor.find( 'input[name="vendor"]' ).val(), 'Рога и копыта' )
            test.ok( editor.find( 'input[name="vendorCountry"]' ).val(), 'Россия' )
            test.ok( editor.find( 'input[name="purchasePrice"]' ).val(), '100500' )
            test.ok( editor.find( 'input[name="barcode"]' ).val(), '0123456789' )
            test.ok( editor.find( 'select[name="units"]' ).val(), 'unit' )
            test.ok( editor.find( 'select[name="units"] > option' ).length > 1 )
            test.ok( editor.find( 'select[name="vat"]' ).val(), '10' )
            test.ok( editor.find( 'select[name="vat"] > option' ).length > 1 )
            test.ok( editor.find( 'input[name="sku"]' ).val(), 'GVOZDI007' )
            test.ok( editor.find( 'input[name="info"]' ).val(), 'У нас их дофига!' )
        </script>
    </p>
    
    <p>Форма отсылается только, если заполнены все необходимые поля.</p>
    <p>
        <script type="wc_test_skip">
            var editor= $jq( '#lh_product_creator_test' )
            
            var result= false
            $lh_product_onSave.listen( editor[0], function( event ){
                event.catched( true )
                result= true
            })
            
            editor.find( '[lh_button="success"]' ).click()
            
            test.not( result )
        </script>
        <script type="wc_test">
            var editor= $jq( '#lh_product_editor_test' )
            
            var result= false
            $lh_product_onSave.listen( editor[0], function( event ){
                event.catched( true )
                result= true
            })
            
            editor.find( '[lh_button="success"]' ).click()
            
            test.ok( result )
        </script>
    </p>
</doc_root>
